<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Phoneme-Grapheme Mapper</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 700px;
    margin: 30px auto;
    padding: 20px;
    background: #f9f9f9;
  }
  h2 {
    text-align: center;
  }
  #controls {
    margin-bottom: 20px;
    text-align: center;
  }
  #controls button {
    margin: 0 10px;
    padding: 8px 14px;
    font-size: 16px;
    cursor: pointer;
  }
  #box-container {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
    margin-bottom: 20px;
  }
  .box {
    position: relative;
    border: 2px solid #333;
    border-radius: 6px;
    min-width: 60px;
    max-width: 180px;
    min-height: 80px;
    padding: 10px;
    box-sizing: border-box;
    background: white;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .box input {
    width: 100%;
    font-size: 32px;        /* large font */
    font-weight: bold;      /* bold text */
    text-align: center;
    border: none;
    outline: none;
    background: transparent;
    resize: none;
    overflow: hidden;
    white-space: nowrap;
  }
  #silent-e-container {
    text-align: center;
    margin-top: 10px;
  }
  #silent-e-container label {
    font-weight: bold;
    font-size: 18px;
  }
  #silent-e {
    font-size: 32px;
    font-weight: bold;
    width: 40px;
    text-align: center;
    border: 2px solid #333;
    border-radius: 6px;
    margin-left: 10px;
    background: white;
  }
</style>
</head>
<body>
  <h2>Phoneme-Grapheme Mapper</h2>
  <div id="controls">
    <button id="addBoxBtn">+ Add Box</button>
    <button id="removeBoxBtn">- Remove Last Box</button>
    <button id="resetBtn">Reset All</button>
  </div>

  <div id="box-container"></div>

  <div id="silent-e-container">
    <label>Silent E:</label>
    <input type="text" id="silent-e" maxlength="1" />
  </div>

<script>
  const boxContainer = document.getElementById("box-container");
  const addBoxBtn = document.getElementById("addBoxBtn");
  const removeBoxBtn = document.getElementById("removeBoxBtn");
  const resetBtn = document.getElementById("resetBtn");
  const silentEInput = document.getElementById("silent-e");

  // Create a new box element with input
  function createBox() {
    const boxDiv = document.createElement("div");
    boxDiv.classList.add("box");

    const input = document.createElement("input");
    input.type = "text";
    input.maxLength = 10;  // allow more letters but box will expand
    input.style.width = "60px"; // start min width

    // Update box input width dynamically
    function updateWidth() {
      // Create a temporary span to measure text width
      const span = document.createElement("span");
      span.style.visibility = "hidden";
      span.style.position = "absolute";
      span.style.whiteSpace = "nowrap";
      span.style.fontSize = input.style.fontSize;
      span.style.fontWeight = input.style.fontWeight;
      span.textContent = input.value || "A"; // measure at least one char
      document.body.appendChild(span);
      let width = span.offsetWidth + 20; // add some padding
      document.body.removeChild(span);
      // Clamp width between min and max width
      width = Math.min(Math.max(width, 60), 180);
      input.style.width = width + "px";
    }

    input.addEventListener("input", () => {
      input.value = input.value.toUpperCase();
      updateWidth();
    });

    // Initialize width for empty box
    updateWidth();

    boxDiv.appendChild(input);
    return boxDiv;
  }

  function addBox() {
    const box = createBox();
    boxContainer.appendChild(box);
  }

  function removeLastBox() {
    if (boxContainer.lastChild) {
      boxContainer.removeChild(boxContainer.lastChild);
    }
  }

  function resetBoxes() {
    const inputs = boxContainer.querySelectorAll("input");
    inputs.forEach(input => {
      input.value = "";
      input.style.width = "60px"; // reset to min width
    });
    silentEInput.value = "";
  }

  // Silent E input logic
  silentEInput.addEventListener("input", () => {
    let val = silentEInput.value.toLowerCase();
    if (val !== "e" && val !== "") {
      // only allow 'e' or empty
      silentEInput.value = "";
    } else {
      silentEInput.value = val === "e" ? "e" : "";
    }
  });

  // Initialize with one box
  addBox();

  addBoxBtn.addEventListener("click", addBox);
  removeBoxBtn.addEventListener("click", removeLastBox);
  resetBtn.addEventListener("click", resetBoxes);
</script>
</body>
</html>
